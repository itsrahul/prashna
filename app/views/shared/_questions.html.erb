<% @questions.each do |question| %>
<div class="card bg-light mb-3" style="max-width: 150rem;">
  <div class="card-header">      
    <h5 class="card-title"><%= link_to question.title.capitalize, question_path(question.id) %></h5>
  </div>
  <div class="card-body">
    <p class="card-text"><%= question.markdown_content %></p>
    <p class="card-text">
      <% if question.topics.exists? %>
        <% question.topics.each do |topic| %>
          <span class="btn btn-dark">
            <%= link_to topic.name , search_topic_path(topic.name) %>
          </span>
        <% end %>
        <% #FIXME_AB: make these topis a link. click on that would filter questions belongs to these topic,, params[:search]: (topic.name) -%>
      <% end %>
    <p class="card-text">Post by -<%= link_to question.user.name, search_user_path(question.user.id) %></p>
    <p>
      <a class="btn btn-primary btn-sm" data-toggle="collapse" href="#collapseAnswers-<%= question.id%>" role="button" aria-expanded="false" aria-controls="collapseExample">
        Answers(<%= question.answers_count %>)
      </a>
      <a class="btn btn-primary btn-sm" data-toggle="collapse" href="#collapseComments-<%= question.id%>" role="button" aria-expanded="false" aria-controls="collapseExample">
        Comments(<%= question.comments_count %>)
      </a>
    </p>
    <div class="collapse" id="collapseAnswers-<%= question.id%>">
      <div class="card card-body">
          <div class="answer-list">
          <% @answers = question.answers.order(net_upvotes: :desc) %>
          <%= render partial: "shared/answers" %>
        </div>
      </div>
    </div>
    <div class="collapse" id="collapseComments-<%= question.id%>">
      <div class="card card-body">
        <div class="question-comment-list flex-container">
          <% @comments = question.comments %>
          <%= render partial: "shared/comments" %>
        </div>
      </div>
    </div>
    <p>
      <a class="btn btn-primary btn-sm" data-toggle="collapse" href="#collapseGiveAnswers-<%= question.id%>" role="button" aria-expanded="false" aria-controls="collapseExample">
        Answer...
      </a>
      <a class="btn btn-primary btn-sm" data-toggle="collapse" href="#collapseGiveComments-<%= question.id%>" role="button" aria-expanded="false" aria-controls="collapseExample">
        Comment...
      </a>
      <a class="btn btn-primary btn-sm" href="<%= report_abuse_path("question", question.id) %>" role="button" aria-expanded="false">
        Report
      </a>
    </p>
    <div class="collapse" id="collapseGiveAnswers-<%= question.id%>">
      <div class="card card-body">
        <%= form_with(model: question, url: question_answers_path(question.id), remote: true, method: :post, class: "form-inline my-2 my-lg-0" ) do |form| %>
          <div class="form-group answer-div">
            <%= form.text_field :answer, class: "form-control mr-sm-2 form-control-sm", placeholder: "Answer the question", autocomplete: "off" %>
            <%= form.submit "Answer", class: "btn btn-secondary btn-sm submit-answer" %>
          </div>
        <% end %>
      </div>
    </div>
    <div class="collapse" id="collapseGiveComments-<%= question.id%>">
      <div class="card card-body">
        <%= form_with(model: question, url: question_comments_path(question.id), remote: true, method: :post, class: "form-inline my-2 my-lg-0" ) do |form| %>
          <div class="form-group comment-div">
            <%= form.text_field :comment, class: "form-control mr-sm-2 form-control-sm submit-comment", placeholder: "Comment on question", autocomplete: "off" %>
            <%= form.submit "Comment", class: "btn btn-secondary btn-sm submit-comment-button" %>
          </div>
        <% end %>
      </div>
    </div>

    </p>
  </div>
</div>
<% end %>
<br>
<% if @questions.respond_to?(:total_pages) %>
<center><%= will_paginate @questions, previous_label: "previous",  class: "flickr_pagination" %></center>
<% end %>